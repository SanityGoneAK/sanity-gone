---
import {
	getAbsoluteLocaleUrl,
	getPathByLocale,
	getRelativeLocaleUrl,
} from "astro:i18n";
import { defaultLang } from "~/i18n/languages";

const preferedLocale = Astro.preferredLocale ?? defaultLang;
const localePath = getPathByLocale(preferedLocale);

const redirectToPreferedLocale = getRelativeLocaleUrl(localePath, "/");
if (redirectToPreferedLocale == "/") {
	return Astro.redirect("/en", 301);
}
return Astro.redirect(redirectToPreferedLocale, 301);
---
